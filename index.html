<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Unico Kitchen â€” Recipes, Shop & Gas</title>
  <style>
    :root{--accent:#ff6b35;--muted:#666}
    body{font-family:Inter, system-ui, Arial; margin:0; background:#fafafa; color:#111}
    header{background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.06);position:sticky;top:0;z-index:50}
    .container{max-width:1100px;margin:0 auto;padding:18px}
    nav{display:flex;gap:12px;align-items:center}
    .brand{font-weight:700;color:var(--accent)}
    .tabs{margin-left:20px;display:flex;gap:8px}
    .tab{padding:8px 12px;border-radius:8px;cursor:pointer}
    .tab.active{background:linear-gradient(90deg, #fff, #fff);box-shadow:0 1px 4px rgba(0,0,0,.05);border:1px solid #eee}
    main{padding:24px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:18px}
    .card{background:#fff;border-radius:12px;padding:12px;box-shadow:0 2px 8px rgba(8,8,8,.04)}
    .card img{width:100%;height:160px;object-fit:cover;border-radius:8px}
    .btn{display:inline-block;padding:8px 10px;border-radius:8px;background:var(--accent);color:#fff;text-decoration:none;cursor:pointer;border:none}
    .secondary{background:#eee;color:#111}
    .small{padding:6px 8px;font-size:13px}
    .ingredients{margin-top:10px}
    .ingredient{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px dashed #f0f0f0}
    .shop-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px}
    .shop-item img{height:120px;object-fit:cover;width:100%;border-radius:8px}
    .cart-icon{margin-left:auto;display:flex;align-items:center;gap:10px}
    .cart-count{background:var(--accent);color:#fff;padding:4px 8px;border-radius:999px;font-weight:700}
    .cart-panel{position:fixed;right:18px;bottom:18px;background:#fff;padding:12px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,.12);width:320px;max-height:60vh;overflow:auto}
    .hidden{display:none}
    footer{padding:18px;text-align:center;color:var(--muted);font-size:14px}
    .gas-block{background:#fff;padding:18px;border-radius:12px}
    .highlight{background:#fff7f2;padding:8px;border-radius:6px;border:1px solid #ffe6d9}
    .notice{font-size:13px;color:var(--muted)}
    .search{padding:8px 12px;border-radius:999px;border:1px solid #eee}
  </style>
</head>
<body>
  <header>
    <div class="container" style="display:flex;align-items:center">
      <div style="display:flex;align-items:center;gap:12px;width:100%">
        <div class="brand">Unico Kitchen</div>
        <div class="tabs" id="navTabs">
          <div class="tab active" data-tab="home">Recipes</div>
          <div class="tab" data-tab="shop">Shop</div>
          <div class="tab" data-tab="gas">Gas</div>
          <div class="tab" data-tab="fridge">Fridge</div>
        </div>
        <div class="cart-icon">
          <div style="cursor:pointer" id="openCart">ðŸ›’ <span id="cartCount" class="cart-count">0</span></div>
          <a id="whatsappBtn" class="btn small" href="#">WhatsApp</a>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <section id="home" class="tab-panel">
      <h2>All Recipes</h2>
      <div class="grid" id="recipesGrid"></div>
    </section>

    <section id="shop" class="tab-panel hidden">
      <h2>Shop</h2>
      <div class="shop-grid" id="shopGrid"></div>
    </section>

    <section id="gas" class="tab-panel hidden">
      <h2>Gas Token Purchase</h2>
      <div class="gas-block">
        <p class="notice">Each gas minute costs 1 token. Choose how many tokens (minutes) you want to buy and add to cart. Replace the price below to match your actual price per token.</p>
        <div style="display:flex;gap:12px;align-items:center;margin-top:12px">
          <label>Tokens (minutes): <input id="gasQty" type="number" min="1" value="1" style="width:80px;padding:6px;border-radius:6px;border:1px solid #eee"></label>
          <div>Price per token: <strong id="tokenPrice">50</strong> KES</div>
          <button class="btn" id="addGas">Add to Cart</button>
        </div>
        <div style="margin-top:12px">Estimated total: <strong id="gasTotal">50</strong> KES</div>
      </div>
    </section>

    <section id="fridge" class="tab-panel hidden">
      <h2>Your Fridge (Saved Ingredients)</h2>
      <div id="fridgeList"></div>
    </section>

  </main>

  <div id="cartPanel" class="cart-panel hidden">
    <h3>Cart</h3>
    <div id="cartItems"></div>
    <div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center">
      <div><strong>Total:</strong> <span id="cartTotal">0</span> KES</div>
      <div>
        <button class="btn small" id="clearCart">Clear</button>
        <button class="btn small" id="composeWhatsapp">Send to WhatsApp</button>
      </div>
    </div>
  </div>

  <footer>
    Built for Unico Kitchen â€” replace images, phone and prices in the code. Ready for GitHub Pages.
  </footer>

  <script>
    // ======= Data (edit these arrays to add your real recipes & shop items) =======
    const PHONE_NUMBER = '254712345678'; // REPLACE with your WhatsApp number in international format (no +). e.g. 2547XXXXXXXX

    const recipes = [
      {
        id: 'r1',
        title: 'Chicken Pilau',
        image: 'https://images.unsplash.com/photo-1546069901-eacef0df6022?w=1200&q=60',
        ingredients: [
          {name: 'Rice', shopId: 's1'},
          {name: 'Chicken', shopId: 's2'},
          {name: 'Pilau Masala', shopId: 's3'}
        ],
        steps: ['Wash rice', 'Brown chicken with spices', 'Add rice and simmer for 20 minutes']
      },
      {
        id: 'r2',
        title: 'Vegetable Stir Fry',
        image: 'https://images.unsplash.com/photo-1546069901-eacef0df6022?w=1200&q=60',
        ingredients: [
          {name: 'Mixed Veg', shopId: 's4'},
          {name: 'Soy Sauce', shopId: 's5'},
          {name: 'Garlic', shopId: 's6'}
        ],
        steps: ['Chop vegetables', 'Stir fry with garlic', 'Add soy and serve']
      },
      {
        id: 'r3',
        title: 'Githeri (Maize + Beans)',
        image: 'https://images.unsplash.com/photo-1546069901-eacef0df6022?w=1200&q=60',
        ingredients: [
          {name: 'Maize', shopId: 's7'},
          {name: 'Beans', shopId: 's8'}
        ],
        steps: ['Soak beans', 'Boil maize and beans together', 'Season and serve']
      }
    ];

    const shopItems = [
      {id: 's1', name: 'Rice 2kg', price: 200, image: 'https://images.unsplash.com/photo-1604908177522-7c2c9fa0d6c3?w=800&q=60', url: ''},
      {id: 's2', name: 'Chicken 1kg', price: 450, image: 'https://images.unsplash.com/photo-1544025162-d76694265947?w=800&q=60', url: ''},
      {id: 's3', name: 'Pilau Masala 100g', price: 60, image: 'https://images.unsplash.com/photo-1543353071-873f17a7a088?w=800&q=60', url: ''},
      {id: 's4', name: 'Mixed Vegetables 500g', price: 120, image: 'https://images.unsplash.com/photo-1506806732259-39c2d0268443?w=800&q=60', url: ''},
      {id: 's5', name: 'Soy Sauce 200ml', price: 150, image: 'https://images.unsplash.com/photo-1523986371872-9d3ba2e2f642?w=800&q=60', url: ''},
      {id: 's6', name: 'Garlic 100g', price: 30, image: 'https://images.unsplash.com/photo-1543353071-873f17a7a088?w=800&q=60', url: ''},
      {id: 's7', name: 'Maize 1kg', price: 90, image: 'https://images.unsplash.com/photo-1601004890684-d8cbf643f5f2?w=800&q=60', url: ''},
      {id: 's8', name: 'Beans 1kg', price: 120, image: 'https://images.unsplash.com/photo-1601004890684-d8cbf643f5f2?w=800&q=60', url: ''}
    ];

    // ======= App state (localStorage-backed) =======
    const state = {
      cart: JSON.parse(localStorage.getItem('cart')||'[]'),
      fridge: JSON.parse(localStorage.getItem('fridge')||'[]'),
      tokenPrice: Number(localStorage.getItem('tokenPrice')||50)
    };

    // ======= Helpers =======
    function save() {
      localStorage.setItem('cart', JSON.stringify(state.cart));
      localStorage.setItem('fridge', JSON.stringify(state.fridge));
      localStorage.setItem('tokenPrice', state.tokenPrice);
      renderCartCount();
    }

    function findShopById(id){return shopItems.find(s=>s.id===id)}

    function addToCart(item){
      // item: {id,name,price,qty}
      const existing = state.cart.find(c=>c.id===item.id);
      if(existing) existing.qty += item.qty||1;
      else state.cart.push({...item,qty:item.qty||1});
      save();
      alert('Added to cart');
    }

    function addRecipeToCart(recipe){
      recipe.ingredients.forEach(ing=>{
        const shop = findShopById(ing.shopId);
        if(shop) addToCart({id:shop.id,name:shop.name,price:shop.price,qty:1});
      });
    }

    // ======= Render functions =======
    function renderRecipes(){
      const el = document.getElementById('recipesGrid'); el.innerHTML='';
      recipes.forEach(r=>{
        const card = document.createElement('div'); card.className='card';
        card.innerHTML = `
          <img src="${r.image}" alt="${r.title}">
          <h3>${r.title}</h3>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button class="btn small" data-id="${r.id}" onclick="toggleDetails('${r.id}')">View ingredients & steps</button>
            <button class="btn small secondary" onclick="addRecipeToCartHandler('${r.id}')">Add recipe to cart</button>
          </div>
          <div id="details-${r.id}" class="ingredients hidden"></div>
        `;
        el.appendChild(card);
      })
    }

    function renderDetails(id){
      const r = recipes.find(x=>x.id===id);
      const container = document.getElementById('details-'+id);
      container.innerHTML='';
      const ingWrap = document.createElement('div');
      r.ingredients.forEach(ing=>{
        const row = document.createElement('div'); row.className='ingredient';
        const left = document.createElement('div'); left.innerText=ing.name;
        const right = document.createElement('div');
        const btn = document.createElement('button'); btn.className='btn small secondary'; btn.innerText='Add to Fridge';
        btn.onclick = ()=>addToFridge(ing.name, ing.shopId);
        right.appendChild(btn);
        row.appendChild(left); row.appendChild(right);
        ingWrap.appendChild(row);
      });
      const stepsEl = document.createElement('div'); stepsEl.style.marginTop='8px';
      stepsEl.innerHTML = '<strong>Steps:</strong>';
      const ol = document.createElement('ol'); r.steps.forEach(s=>{const li=document.createElement('li');li.innerText=s;ol.appendChild(li)});
      container.appendChild(ingWrap); container.appendChild(stepsEl); container.appendChild(ol);
    }

    function renderShop(){
      const el = document.getElementById('shopGrid'); el.innerHTML='';
      shopItems.forEach(s=>{
        const card = document.createElement('div'); card.className='card shop-item';
        card.id = 'shop-'+s.id;
        card.innerHTML = `
          <img src="${s.image}" alt="${s.name}">
          <h4>${s.name}</h4>
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div><strong>${s.price}</strong> KES</div>
            <div style="display:flex;gap:8px"><button class="btn small" onclick="addToCartHandler('${s.id}')">Add to cart</button></div>
          </div>
        `;
        el.appendChild(card);
      })
    }

    function renderFridge(){
      const el = document.getElementById('fridgeList'); el.innerHTML='';
      if(state.fridge.length===0) el.innerHTML='<div class="notice">Your fridge is empty â€” add ingredients from recipes.</div>';
      state.fridge.forEach((f,idx)=>{
        const div = document.createElement('div'); div.className='card';
        const shop = findShopById(f.shopId);
        div.innerHTML = `<div style="display:flex;gap:12px;align-items:center"><div><strong>${f.name}</strong></div><div style="margin-left:auto"><button class="btn small" onclick="goToShopItem('${f.shopId}')">View in shop</button></div></div>`;
        el.appendChild(div);
      })
    }

    function renderCartPanel(){
      const el = document.getElementById('cartItems'); el.innerHTML='';
      let total = 0;
      state.cart.forEach((c,idx)=>{
        const div = document.createElement('div'); div.style.display='flex'; div.style.justifyContent='space-between'; div.style.alignItems='center'; div.style.padding='6px 0';
        div.innerHTML = `<div>${c.name} x ${c.qty}</div><div>${c.price*c.qty} KES <button class='btn small secondary' onclick="removeCartItem(${idx})">-</button></div>`;
        el.appendChild(div);
        total += c.price*c.qty;
      });
      document.getElementById('cartTotal').innerText = total;
    }

    function renderCartCount(){
      const c = state.cart.reduce((s,i)=>s+i.qty,0);
      document.getElementById('cartCount').innerText = c;
    }

    // ======= Actions =======
    function toggleDetails(id){
      const el = document.getElementById('details-'+id);
      if(el.classList.contains('hidden')){ renderDetails(id); el.classList.remove('hidden'); } else el.classList.add('hidden');
    }
    function addRecipeToCartHandler(id){ const r = recipes.find(x=>x.id===id); addRecipeToCart(r); renderCartPanel(); }
    function addToCartHandler(shopId){ const s = findShopById(shopId); addToCart({id:s.id,name:s.name,price:s.price,qty:1}); renderCartPanel(); }
    function addToFridge(name, shopId){
      // add to fridge state and immediately go to shop tab and scroll to item
      const existing = state.fridge.find(f=>f.name===name);
      if(!existing) state.fridge.push({name,shopId});
      save();
      // switch to shop
      switchTab('shop');
      setTimeout(()=>{
        const target = document.getElementById('shop-'+shopId);
        if(target){ target.scrollIntoView({behavior:'smooth',block:'center'}); target.style.boxShadow='0 4px 18px rgba(255,107,53,.14)'; setTimeout(()=>target.style.boxShadow='none',1200); }
      },300);
      renderFridge();
    }

    function goToShopItem(shopId){ switchTab('shop'); setTimeout(()=>{document.getElementById('shop-'+shopId).scrollIntoView({behavior:'smooth',block:'center'})},200); }

    function removeCartItem(index){ state.cart.splice(index,1); save(); renderCartPanel(); }
    function clearCart(){ if(confirm('Clear cart?')){ state.cart=[]; save(); renderCartPanel(); } }

    // Gas logic
    const gasQtyEl = document.getElementById('gasQty'); const tokenPriceEl = document.getElementById('tokenPrice'); const gasTotalEl = document.getElementById('gasTotal');
    tokenPriceEl.innerText = state.tokenPrice;
    function updateGasTotal(){ const qty = Number(gasQtyEl.value||1); gasTotalEl.innerText = qty*state.tokenPrice; }
    gasQtyEl.addEventListener('input', updateGasTotal);
    document.getElementById('addGas').addEventListener('click', ()=>{
      const qty = Number(gasQtyEl.value||1);
      addToCart({id:'gas-token',name:`Gas token x${qty}`,price:state.tokenPrice,qty:qty});
      renderCartPanel();
    });

    // Compose WhatsApp message
    function composeMessage(){
      let lines = ['Unico Kitchen Order:'];
      if(state.cart.length===0) lines.push('(Cart is empty)');
      state.cart.forEach(c=>{ lines.push(`- ${c.name} x ${c.qty} = ${c.price*c.qty} KES`); });
      const total = state.cart.reduce((s,i)=>s+i.price*i.qty,0);
      lines.push(`Total: ${total} KES`);
      if(state.fridge.length>0){ lines.push('Saved fridge items:'); state.fridge.forEach(f=>lines.push(`- ${f.name}`)); }
      return lines.join('\n');
    }

    document.getElementById('composeWhatsapp').addEventListener('click', ()=>{
      const msg = composeMessage();
      const url = `https://wa.me/${PHONE_NUMBER}?text=${encodeURIComponent(msg)}`;
      window.open(url,'_blank');
    });

    document.getElementById('openCart').addEventListener('click', ()=>{
      const panel = document.getElementById('cartPanel'); panel.classList.toggle('hidden'); renderCartPanel();
    });
    document.getElementById('clearCart').addEventListener('click', clearCart);

    // nav
    document.getElementById('navTabs').addEventListener('click', (e)=>{ if(e.target.dataset.tab) switchTab(e.target.dataset.tab); });
    function switchTab(name){
      document.querySelectorAll('.tab').forEach(t=>t.classList.toggle('active', t.dataset.tab===name));
      document.querySelectorAll('.tab-panel').forEach(p=>p.classList.toggle('hidden', p.id!==name));
      // render specific
      if(name==='shop') renderShop();
      if(name==='home') renderRecipes();
      if(name==='fridge') renderFridge();
      if(name==='gas') updateGasTotal();
    }

    // initial render
    renderRecipes(); renderShop(); renderCartCount(); renderFridge(); renderCartPanel();

    // expose some functions to inline handlers (simple approach for single file)
    window.toggleDetails = toggleDetails; window.addRecipeToCartHandler = addRecipeToCartHandler; window.addToCartHandler = addToCartHandler; window.addToFridge = addToFridge; window.goToShopItem = goToShopItem; window.addToCart = addToCart; window.composeMessage = composeMessage; window.findShopById = findShopById; window.removeCartItem = removeCartItem;

  </script>
</body>
</html>
